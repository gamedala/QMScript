[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=5c06f3c4-9aac-48eb-bcd5-2b949c697947
Description=多窗口UI範例
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event Form1.Button1.Click'儲存參數
    血量 = Form1.Slider1.Value'取血量參數
    魔力 = Form1.Slider2.Value'取魔力參數
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    Call Plugin.File.WriteINI(線程, "血量", 血量, "D:\test111.ini")'將血量參數寫入線程類別內
    Call Plugin.File.WriteINI(線程, "魔力", 魔力, "D:\test111.ini")
End Event

Event Form1.Button2.Click'指定下拉目標啟動
	Form1.ComboBox1.List = Plugin.Window.Search("未命名 - 記事本")
	
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread test()
    End If
End Event

Event Form1.ComboBox1.SelectChange
	Form1.ComboBox1.List = Plugin.Window.Search("未命名 - 記事本")
	
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.Button2.Caption = "停止"
    Else 
        Form1.Button2.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "D:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "D:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event

Sub test
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇"
    For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub

Event Form1.Load
    Call test
End Event
