[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=5c06f3c4-9aac-48eb-bcd5-2b949c697947
Description=多窗口UI範例
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event Form1.Button1.Click'儲存參數
    血量 = Form1.Slider1.Value'取血量參數
    魔力 = Form1.Slider2.Value'取魔力參數
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    Call Plugin.File.WriteINI(線程, "血量", 血量, "D:\test111.ini")'將血量參數寫入線程類別內
    Call Plugin.File.WriteINI(線程, "魔力", 魔力, "D:\test111.ini")
End Event

Event Form1.Button2.Click'指定下拉目標啟動
	Form1.ComboBox1.List = Plugin.Window.Search("未命名 - 記事本")
	
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread test()
    End If
End Event

Event Form1.ComboBox1.SelectChange
	Form1.ComboBox1.List = Plugin.Window.Search("未命名 - 記事本")
	
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.Button2.Caption = "停止"
    Else 
        Form1.Button2.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "D:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "D:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event

Sub test
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇"
    For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub

Event Form1.Load
    Call test
End Event
