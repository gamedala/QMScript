[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=0d657ecf-26fd-408d-8db1-d97ae39b584c
Description=株光_自動刷副本1024-768
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[Script]
//PutAttachment "c:\dm", "*.*"
//第一次使用拿掉上方註解,後請放回
Call 大漠設定()
Call 窗口綁定()

PID_1=BeginThread(驗證技能)
Global Start
Start = 0
NpcX = 510
NpcY = 260
對話延遲 = 300
過圖延遲 = 1500
怪物陣容 = 3
//怪物陣容 A陣=0 B陣=1 C陣=2 D陣=3
Do
	If Start = 0 Then 
		now_map = Plugin.Memory.Read32Bit(Hwnd1, &H0015F258)
		//MsgBox now_map
		If now_map = 16 Then
			now_map_X = Plugin.Memory.Read32Bit(Hwnd1, &H010F07A8)
			now_map_Y = Plugin.Memory.Read32Bit(Hwnd1, &H010F07AC)
			IF now_map_X = 216 And now_map_Y = 209 Then
				dm_ret = dm.FindStr(225,43,920,345,"每日副本","ffffff-000000",0.9,intX,intY)
				If intX > 0 And intY > 0 Then 
					dm.MoveTo intX + 30, intY + 50
					dm_ret = dm.FindStr(372,161,621,384,"每日副本","94bdf7-000000",1.0,intX,intY)
					//是否可點擊到每日副本NPC
					If intX > 0 And intY > 0 Then 
						Delay 對話延遲
						dm.LeftClick 

						Val_inst = Plugin.Memory.Read32Bit(Hwnd1, &H01107FD0)
						If Val_inst = 1397968706 Then
							Delay 對話延遲
							dm.KeyPress 13
							Delay 對話延遲
							dm.KeyPress 40
							Delay 50
							dm.KeyPress 13
						ElseIf Val_inst = 1397968640 or Val_inst = 0 Then
							Call 按鍵迴圈(13,3,對話延遲)
						End If
					End If
				End If
			End If
		ElseIf now_map = 8 Then
			dm.MoveTo NpcX, NpcY
			dm_ret = dm.FindStr(372, 161, 621, 384, "開始", "94bdf7-000000", 1.0, intX, intY)
			//是否可點擊到開始NPC
			If intX > 0 And intY > 0 Then 
				dm.LeftClick
				Delay 對話延遲
				Call 按鍵迴圈(13,2,對話延遲)
				Call 按鍵迴圈(40,怪物陣容,50)
				Call 按鍵迴圈(13,4,對話延遲)
				Start = 1
			End If
		End If
	Else
		Delay 1000
	End If
Loop

Sub 驗證技能()
Call 大漠設定()
Call 窗口綁定()
技能1 = 115
技能2 = 113
驗證卷軸 = 115
Do
	If Start = 1 Then
		now_map = Plugin.Memory.Read32Bit(Hwnd1, &H0015F258)
		If now_map = 16 Then 
			Start = 0
		Else
			dm_ret = dm.FindPic(10, 520, 255, 740, "C:\dm\ban.bmp", "000000", 0.8, 0, intX, intY)
			If intX > 0 And intY > 0 Then 
				Call 驗證()
			Else
				dm.KeyPress 技能1
				dm.KeyPress 技能2
			End If
		End If
	Else
		Delay 1000
	End If
Loop
End Sub


Function 按鍵迴圈(按鍵,次數,延遲)
	For 次數
		dm.KeyPress 按鍵
		Delay 延遲
	Next
End Function

Function 驗證()
	call 按鍵迴圈(驗證卷軸, 11, 15)
	dm_ret = dm.FindPic(0, 0, 1024, 768, "C:\dm\msg.bmp", "000000", 0.9, 0, intX, intY)
	If intX > 0 And intY > 0 Then 
		dm_ret = dm.FindStr(intX, intY, intX+280, intY+180, "=?", "000000-000000", 1.0, intX, intY)
		If intX > 0 And intY > 0 Then 
			Delay 500
			verify = dm.Ocr(intX - 110, intY -7, intX , intY + 7,"000000-000000",1.0)
			n = Len(verify)
			i = 1
			verify2 = "" 
			For n
				y = Mid(verify, i, 1)
				m = Asc(y)
				If m >0 And m<>32 Then
					verify2 = verify2 & y
				End If
				i = i+1
			Next
			verify = Eval(verify2)
			Call Plugin.Bkgnd.SendString(Hwnd1, verify)
			Call Plugin.Msg.Tips("驗證提示: " & verify)
			dm.KeyPress 13
		End If
	End If
End Function

Function 大漠設定()
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath()
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0,"pass.txt")
	//pass.txt字典讀取
End Function

Function 窗口綁定()
	Hwnd1 = Plugin.Window.MousePoint()
	dm_ret = dm.BindWindow(Hwnd1,"gdi","dx2","windows",4)
	//大漠綁定視窗
End Function
