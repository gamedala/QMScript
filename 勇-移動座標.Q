[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=4549043b-c8f5-453a-a0b5-83d4ea9b60f4
Description=勇-移動座標
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
UEsDBBQAAgAIACh1wVQgG2wLjwAAACIBAAAGABEAq2kudHh0VVQNAAegepdiBgaZYjVyj2JNkDkOxDAMA/sA+YXqLKUoOmrD/v+TVrYb1wNyCCpyDEBATHjwsFDel3HiExZVdQ6SjWIiMIJFRFuYgd6NdCHDqxzho81CPVPIXnWiEdFB30Y20TuQG2kMkC1U8UKtZNXUtaMD5IfLnXnNqIUOip3ihSKRc7yElyuPQh8MFohCvVw4ENAwNVai3xbVJ7ivP1BLAQIXCxQAAgAIACh1wVQgG2wLjwAAACIBAAAGAAkAAAAAAAAAIACAgQAAAACraS50eHRVVAUAB6B6l2JQSwUGAAAAAAEAAQA9AAAAxAAAAAAA


[UIPackage]
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


[Script]
線程ID=BeginThread(主程序)

Sub 主程序
Call 大漠設定()
Delay 100
Dim tpXY, toX, toY
	Do
		初始 = 時間檢查()
    	Call 移動座標(int(Form1.X軸.Text), int(Form1.Y軸.Text))
		//dm.KeyPress 32
		Do
			dm.KeyDown 32
			dm.KeyUp 32
		Loop While 初始+int(Form1.時間.Text) > 時間檢查()
	Loop
End Sub

Sub 移動座標(toX, toY)
	Do
		s = dm.Ocr(948, 0, 1003, 18, "ffffff-000031", 1.0)
		tpXY = Split(s, "/")
		X = Sgn(toX - tpXY(0)) : Y = Sgn(toY - tpXY(1))
		TracePrint "X " & tpXY(0) & " Y " & tpXY(1)
		If toX = int(tpXY(0)) And toY = int(tpXY(1)) Then 
			TracePrint "找到位置停止"
			Left_down = False
			dm.LeftUp
			Exit Do
		Else 
			If X = 0 And Y = 1 Then '下
				dm.MoveTo 510,350
			ElseIf X = - 1  And Y = 1 Then '右下
				dm.MoveTo 420,350
			ElseIf X = -1 And Y = 0 Then '右
				dm.MoveTo 420,410
			ElseIf X = -1 And Y = -1 Then '右上
				dm.MoveTo 420,450
			ElseIf X = 0 And Y = -1 Then '上
				dm.MoveTo 510,450
			ElseIf X = 1 And Y = -1 Then '左上
				dm.MoveTo 570,450
			ElseIf X = 1 And Y = 0 Then '左
				dm.MoveTo 570,410
			ElseIf X = 1 And Y = 1 Then '左下
				dm.MoveTo 570,350
			End If
			dm.LeftClick
//			If Left_down <> True or  Then 
//				dm.LeftDown 
//				Left_down = True
//			End If
		End If
		Delay 200
	Loop
End Sub

Function 時間檢查()
    Set sc = CreateObject("MSScriptControl.ScriptControl")
    sc.Language = "JavaScript"
	時間檢查 = sc.eval ("new Date().getTime();")
End Function

Sub 大漠設定()
	If Plugin.File.GetFileLength("c:\dm\勇.txt") <> 290 Then 
    	PutAttachment "c:\dm", "勇.txt"
    	TracePrint "釋放字典."
	End If
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath()
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0,"勇.txt")
	Hwnd = Plugin.Window.MousePoint()
	dm_ret = dm.BindWindow(Hwnd,"gdi","dx2","dx",4)
	TracePrint "窗口:" & Hwnd & " 綁定狀態:" & dm_ret
End sub
