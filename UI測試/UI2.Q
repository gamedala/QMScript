[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=66e72b68-b09d-4069-8903-d4e9bec302b1
Description=UI2
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Dimenv hwnd

Event Form1.Load   
    call 獲取列表 
End Event  

Event Form1.button1.Click
    For i = 1 To Form1.InputBox1.Text
        //打開記事本
        RunApp "Notepad.exe"
        //判斷記事本是否打開
        do
            hwnd = Plugin.Window.Find(0, "未命名 - 記事本")//獲取記事本句柄
        Loop while (Hwnd=0)
        Call Plugin.Window.Move(hwnd,i*50+100,200) //設置記事本出現在屏幕上的位置，橫坐標遞增，然後窗口可以依次排列開，方便查看運行效果
        //////////////修改窗口標題////////////////
        Do
            If stext ="第"&i&"窗口" Then
                Exit Do
            End If
            call Plugin.Window.SetText(hwnd,"第"&i&"窗口")
            stext = Plugin.Window.GetText(hwnd)
        Loop
        ////啟動線程每使用BeginThread啟動一次打字子程序，都是生成一條新的線程
        線程ID = BeginThread(打字)
        //將窗口句柄、線程id記錄到ini文件中，便於之後調用
        Call Plugin.File.WriteINI("窗口句柄", "第"&i&"窗口",hwnd, "C:\記錄.ini")
        Call Plugin.File.WriteINI("線程ID", "第"&i&"窗口",線程ID, "C:\記錄.ini")
    Next
    Form1.button1.Enabled=False
End Event
//////////////////關閉線程(StopThread)////////////////////////////
Event Form1.button3.Click
    Form1.button1.Enabled = true
    For i = 1 To cint(Form1.InputBox1.Text)
        關閉線程id = Plugin.File.readINI("線程ID", "第" & i & "窗口", "C:\記錄.ini")
        StopThread 關閉線程id //關閉線程
        Call Plugin.Window.Close(Plugin.File.readINI("窗口句柄", "第" & i & "窗口", "C:\記錄.ini")) //關閉窗口
    Next
End Event
////////////////線程暫停(PauseThread)、線程恢復(ContinueThread)///
Event Form1.button2.Click
    If Form1.button2.Caption = "暫停" Then
		For i = 1 To cint(Form1.InputBox1.Text)
			暫停線程id = Plugin.File.readINI("線程ID", "第" & i & "窗口", "C:\記錄.ini")
			PauseThread 暫停線程id
		Next
        Form1.button2.Caption = "繼續"
    else
		For i = 1 To cint(Form1.InputBox1.Text)
			繼續線程id = Plugin.File.readINI("線程ID", "第" & i & "窗口", "C:\記錄.ini")
			ContinueThread 繼續線程id
		Next
        Form1.button2.Caption = "暫停"
    End If
End Event
////////////////打字線程/////////////////////////
Sub 打字()
    窗口句柄 = hwnd
    TracePrint hwnd &"--"&窗口句柄

    Do
        hwnds = Plugin.Window.FindEx(窗口句柄, 0, "RichEditD2DPT", 0)
    Loop While(hwnds=0)
    For i = 1 To 200
        Call Plugin.Bkgnd.SendString(hwnds, i)
        Call Plugin.Bkgnd.KeyPress(Hwnds, 13)
    Next
End Sub

Event Form1.ComboBox1.SelectChange
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, "|")(1) > 0 Then '如果線程編號大於0 
        Form1.Button4.Caption = "停止"
    Else 
        Form1.Button4.Caption = Split(帳號選擇內容, "|")(1)
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄

End Event

Sub 獲取列表
	Form1.ComboBox1.List = Plugin.Window.Search("Ragnarok")//搜索標題指定句柄 
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇"
    For i = 0 To UBound(Split(Form1.ComboBox1.List, "|"))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|Ragnarok-" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|Ragnarok-" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub

'啟動 指定下拉目標啟動
Event Form1.Button4.Click
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, "|")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 0 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|Ragnarok-" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ", 0" '迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|Ragnarok-" & Split(Form1.ComboBox1.List, "|")(i) '迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread 獲取列表()
    End If
End Event