[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=1d6bd851-1026-4c80-ac67-4d1192fc4976
Description=UI
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event Form1.Button1.Click'儲存參數
    血量 = Form1.Slider1.Value'取血量參數
    魔力 = Form1.Slider2.Value'取魔力參數
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    Call Plugin.File.WriteINI(線程, "血量", 血量, "C:\test111.ini")'將血量參數寫入線程類別內
    Call Plugin.File.WriteINI(線程, "魔力", 魔力, "C:\test111.ini")
End Event
Event Form1.Button2.Click'指定下拉目標啟動
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread test()
    End If
End Event
Event Form1.ComboBox1.SelectChange
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.Button2.Caption = "停止"
    Else 
        Form1.Button2.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "C:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "C:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event
Sub test
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇"
    For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub
