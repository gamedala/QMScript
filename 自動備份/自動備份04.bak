[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=adf335d9-b002-4563-b3d6-7a8e9f8bfe33
Description=UI
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Event Form1.Load
    call test 
End Event  
'保存 儲存參數

Event Form1.Button1.Click'儲存參數
    血量 = Form1.Slider1.Value'取血量參數
    魔力 = Form1.Slider2.Value'取魔力參數
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    Call Plugin.File.WriteINI(線程, "血量", 血量, "D:\test111.ini")'將血量參數寫入線程類別內
    Call Plugin.File.WriteINI(線程, "魔力", 魔力, "D:\test111.ini")
End Event

Event Form1.Button2.Click'指定下拉目標啟動
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread test()
    End If
End Event

Event Form1.ComboBox1.SelectChange
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    Form1.Label1.Caption = Split(帳號選擇內容, ",")(0) '取的選單(0)
	If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.Button2.Caption = "停止"
    Else 
        Form1.Button2.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "D:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "D:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event

Sub test
	Form1.ComboBox1.List = Plugin.Window.Search("Ragnarok")'搜索標題指定句柄
	//MsgBox Form1.ComboBox1.List
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇窗口"
    For i = 0 To UBound(Split(Form1.ComboBox1.List, "|"))
    	AID = int(Plugin.Memory.Read32Bit(Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0), &H011CCDFC))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|" & AID & "," & Split(Form1.ComboBox1.List, "|")(i) '迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub