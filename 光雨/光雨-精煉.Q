[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=463febaf-60be-4463-8475-e6b55f0d2801
Description=光雨-精煉
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[UIPackage]
UEsDBBQAAgAIAG4DrFTrCOxNMQUAAAg2AAAJABEAVUlQYWNrYWdlVVQNAAd7VHxie1R8YntUfGLtWktvG1UU/saexHZinAdJmialuI9Amj5T6BMoaiIqIpWCaocKpCK5wdAqjl05AYUF/A+WqexKOAiBUEUKUqmEWqnqAgRCYtEFdIMQSOy6w+bcmTv4Ok3p3EcyGOVEx2fi+N7vPs8534nDcOW7b7t+Xvhs4Bcsk2MIo1qLoVV4z+LqSCcQ4r9Xa7Wa93ZtXZpK/iK1+R6yvW4hjZDGSKOkbaSPkLaTxkkT7tajg7SL9FHSbtIe0j7SXtINpBtJ+3m/1fVl/s/KaRToZw5JvIA82SLeg4z00Ynx+rIe8tlPz/wYSWd/ssL0fD3hvjeJCeyDukRhWR5+30NwPSv+bRxpnNQYQRt5QA+/RQE/Tet9EVmcQgYzZGWlGyFn/l3c9/ptZ3Pr3c//gz5N8znwL3Nal/vlRKE4o3H9wNqParS3oCe67XXlysKN33TmL3FlV6W9qt+p+79QQ87nd888X8miTgbnkFMcQ4L8XzvPU/zihwT/9youYJZUdQSdCvMPC/inCTWDN/EyrUNOMvZ6/j/O+/SLbwv4acKfp7ivsf+W7PxbhP0fp+wjR1pUHEmPAn6rMP86/hjtwxSm5fGdfLlDYv0jy/Z/SnP9WX4elcCPws3hRTlLl+Iemk8iAePfW3nNnbD0UiqZyuRnk6ls8cJbq4Q/tPiGVvvXyfMUyf9k6VVFmP/t5XfK7/mLCef/JN09+VvXeP47eX9+8dtWvP8pGsd5Wge5aNhP99/jwH7x2wX845T9X3RiQJE0T2OQi0J9NP8YXF7uFz8u4J+guef1/I90/GP+6tl/5p+j6Ps2jYGte17F/0vjJxr2P0PrP0djYOsw5uyDFwnqZ+PBMqwQfzoE/DGnf/f++cFb4fxZPajX3fy06RTwdf2Hbv6pK+OFmXOFscK8bnvVHL7Z+UuaTv6ck/uqnD7H/0jfvy7h/L1C+POEnqMsXEUSCvjdDfef1X/UGVwbLIvxiZ1wa54ryWrXf56QvP8sXkX5cxD8j/mrGH82wf8eJ7sZ/uNfL4zyPyspuf59MMv/BuDW3P3ib4B5/jckgS/+v8gU/xuRwO+HWf43SHabBP5GmOV/W8huksAfwP38T1V0438H9wfM+w8rtA86foY12+uOX5d/GuB/0v5/EGb533Z+p/3ib4JZ/sfO7ZMS+I/BLP9j/W2VwN+MYPkfi9ce/5sgbLbms4r4cQX8JOq5WsrJPV0fnKV7ICvdCvhbhPU/5Zy9Gdr7nDL/k8XfKuCHEf/6z2t3lt4vf/VNdfFj+8vfv/jerlRvnF0j/6nLP0eunNdqP7iQDnT8pvjrfsX2L9J5e1e5+uD6nx2Qy3+3LfM/U3iH7v/a8c/tAv4EoTMPqIauVn8awnL+qbp7jd8/2POAz6w2/3xGcv8ZXw2Sf7JYbZJ/su8dPAX/8XcYZvnnAcn13yHgN3v9SldM8Bd2e2cdXyYvoYDnb6L+sJfsLonzPwLz9YejCLb+8LwE/k6YrT+wb68dlsDfBbP1h4NkRyXwd6NefwiCf+6BWf55hM/JL/5emOWfz8HlU37x90HM//Uk6PpFL+cvtz+/efmPpRn7+mulM+ylxF4m7cu/Vo7bH92p/GBfmyrl7PJ06a5drpTutpanl25fvdRarjAT+eTWbtaQ2xK3k8yyHphlnTDL+mGWdeVY6i3m/M56cp4qVy8tfrBG/luXf5ioP7D4d0ji/I0i2PrDfgRbf2C54of8OYj6w0EEW384JOCb4J/HIJf/Hkaw/PMIguWfRwX8Zq+frIue/A1QSwECFwsUAAIACABuA6xU6wjsTTEFAAAINgAACQAJAAAAAAAAAAAAAIAAAAAAVUlQYWNrYWdlVVQFAAd7VHxiUEsFBgAAAAABAAEAQAAAAGkFAAAAAA==


[Script]
If Plugin.File.GetFileLength("c:\dm\光雨精煉.txt") = 0 Then 
    PutAttachment "c:\dm", "*.*"
End If
Call 大漠()
Delay 500
裝備位置 = 1
//自己修改視窗NPC位置(綁定具柄後的位置)
dm.GetCursorPos x,y
NPC座標 = array(x,y)
//類型1 精煉 2附魔
動作類型 = 1
//洞數 1=4洞 2=3洞
洞數 = 2

Do
	Do
		Delay 200
		dm_ret = dm.FindStr(6, 638, 221, 697, "6", "00ffff-000000", 1.0, intX, intY)
		If intX > 0 AND intY > 0 Then
			Call Plugin.Media.Beep(988, 100) //蜂鳴一秒
		End If
	Loop Until  intX = -1 AND intY = -1
	對話視窗 = Plugin.Memory.Read32Bit(Hwnd, &H00F80558)
	If 對話視窗 > 0 Then 
		If 動作類型 = 1 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "物品選項簡略設置", "0063ce-000000", 1.0, intX, intY)
		ElseIf 動作類型 = 2 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "附魔道具說明", "008cff-000000", 1.0, intX, intY)
		End If
		//TracePrint "intX: " &intX&" intY :"&intY
		If intX > 0 AND intY > 0 Then 
			For i = 1 To 裝備位置
				TracePrint "裝備位置: "&裝備位置&" 按: down " & i
				dm.KeyPress 40
				Delay 100
			Next
			dm.KeyPress 13
		Else 
			If 動作類型 = 2 Then 
				dm_ret = dm.FindStr(0, 0, 1024, 768, "第四洞", "008cff-000000", 1.0, intX, intY)
				If intX > 0 AND intY > 0 Then 
					If 洞數 > 1 Then 
						For i = 1 To 洞數
							TracePrint "洞數: "&洞數&" 按: down " &i
							dm.KeyPress 40
							Delay 20
						Next
					End If	
				End If
				dm_ret = dm.FindStr(0, 0, 1024, 768, "請繼續", "000000-000000", 1.0, intX, intY)
				If intX > 0 AND intY > 0 Then 
					dm.KeyPress 40
					Delay 20
				End If
			End If
			dm.KeyPress 13
		End If
	Else 
		dm.MoveTo NPC座標(0),NPC座標(1)
		dm.LeftClick
	End If
	Delay 50
Loop

Function 大漠()
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath()
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0, "光與精煉.txt")
	Hwnd = Plugin.Window.MousePoint()
	dm_ret = dm.BindWindow(Hwnd, "gdi", "dx2", "dx", 4)
End Function
