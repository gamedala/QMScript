[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=134846dd-0571-49e9-82cf-154ea695f2e4
Description=光雨-時空附魔
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
UEsDBBQAAgAIAGq2LlXf98GHPA8AAAjmAAAJABEAVUlQYWNrYWdlVVQNAAfpWiJj6VoiY+laImPtXQd4VtUZfm/CSACBIBsEBEGGIiIyFAdBlrIkcaCABoyAhoQmQUGt0rpX1dZttWLBiVoH7kFVHHWPulv3tmqr4iZ9zz+am0Dq/93z8X/8Jud5Xr6Q/Oe+/7lnvt937rnZiKdnns57c9lNnd9CrbQrsrGuKhdNQr8LEoil1kAWTTaxrqqqKvnrqoaUUeknohHrbUfC1XVjoimRS+QQzYjNiOZEC6JlvOrRisgjNifaEG2J9kQ7ogPRiehIdCa6El2ILYjuRDeiB9GT2JLoRfQmtiL6EP2IrYm+RH9iG2IAsS2xHTGQGEQMJrYndiCGEkOIYcR8YgQxnNiJGEnsTOxC7BZr28DuRD4xihhNjCX2IMYQ44gJxHhiT2IisRcxiZhCTCamEtOIvYkCYl+ikNiH2I+YTuxPHEDMIA4kZhIHEbOIg4nZRBExhziUOIQoJuYShxHziMMT/WsBbQlRSiwkyohfJf62zqP+p/FKZahkfYzhtStRjiWQpPZsMclrBT/z2alr3q2Y8OjLgRszVo+J/24f3ulBiJ5yEARJ/p1+hjdpw38bzVqb6PENmoX4G0fgL+T9Xshan8yWsCBW+7LUBlkx/rzE2JtqvkYJm2w/DaifGFtWvsCj+8Hl394jfwC/5JvfN61atuYjn/ILuuxGyR913Kke/7JqrPlSrbPkWOlmnSLOhCURv0NLjn/NEV+npMqfFRr/9uVqoYKI+g1aRyh/doh/GlmLOPNP4X0oEc69yfG/ReKaqfI3CvEXkn8x532P+g+k5W8cqv/RXH2UEOURv0nbCPxNQuWv5s9nPcyJrbeE/LH1civB/W9aq/7neN5/tz7PEfDnIL6GD6eZ7BRrkXmpqTH/2g3f89i0NKmgR0FRaUWPguLy+YduJP7e183yyn8AR55yjj/F/DdKcuNvu0SfSrX95Yba/0T2PXmvq9n+Wyeulyp/sw32/wJ+j3m8D7LZsCP7f1IDp8rfPMQ/iqv/hbE5oJwo5XeQzULtWf5cxHV5qvwtQvxjWfZSv/FHPP+58Wrk/8pfwtl3Lr+Du++lUcZ/MX/LGvVfxPtfye/g7kN+rB6SM0F126g79Y0w/7QK8efHrh/vf6nwbaD9BW1R7XdLJU/rEL/v+OG7/vRNE4tmF5f45vdYwGe6filky6+MrX2jtL7Y+CPuf3mh9jeV/IvJXsJVeJTUMgJ/mxr93/l/ojcA5//JQtxX2amOz6TD/9MbqY//br5Krr8t9J8br5JxBQ39l/Qpp8rfDqr6L+iBuL86Vf720NV/zsfeQcDfAbb6ryPia7B4/0u//usEXf3nYhu9BPe/M3T1n4uhdBXwd0G1/rvhsRXfr56+fNzKX8Mk+a4fWiX6vou/bBshfxZsk69+9V0/KOg/8fjfFbr6b6vEmJIq/xZQ1X+x8aePgL8bdPWfK09PAX932Oq/HrDVf1siPP/F73sFa8HVgfQ7dIzA37NG/S8iXxlb33wcFW39J+bvFeK39l9ZJxX9ODh6fmv9GNc/0QsQjn8PqOMz6dA/wwTjn5svLPWP02qa+sep10GC8veBrv5xrWeEgH9r6Ooftz+on4C/L2z1Tz/Y6p/+ofL7poR+KMxk/TAMcf0wNkL+TNcPGvrX6a4dBf1vAHT1r9v/N1DAvw2q9a+F/tkWuvpnaKJPp8o/EPr6Z7iAfzvo6h93vSEC/kGw1T9uvrbUP4ND5fddP9Z3/TChdOGiyvyyxVHz+3refOvPQv/uAFv9OwS14z87ePT/IHD+/NMQ31++oZQO/TNBMP65uTon8bOF/hkauv8a+sft388XlH8YdPWPe25gTwH/cOjqH/c8w84C/hHQG/990yBjfl/94J73cPGUqxFf10hTtnH5LfTvTqF2p6B/xePPztCN/7lnisYJ+t9I6Oof9yjN7gL+XWCrf3aFrv4Zn7inqfLvBt39f5MQf0YsVf7doat/3LNpYwX8o0L8vuOPtX6wnr98k+/+u/6r5nnlt9C/+bDVv6MR3n9WxPVfBY5M7MOUpij6Y48Q/yTqn5LY/tOJRKl4Der8v64/TxH0/zEh/smxci/gXSiJvP9UWv6xIf7x5Dsi8u7X+Pg3GbL9r+NQ0/8zh3VQkcb9j+ND/G7WKY8xlyR2H2/89j8hxN9lWaHp+OftPym09Z9kun6K+z+GRM4fjv8W1PGZdPg/DhKMf06rW/o/9oKu/yN51kCq/BOh6/9wZxwcLOCfBF3/hxvB9hbwT4Zt/HcKbPXvVOjFfzX8J270cf6T8RHya5Ujasp0/aTh/3B1OFPQ//aGrv/jQMTj96nyT4Ot/6MAuv6PWYkypcpfCF3/hzu/ZraAfx/o+j/cGTozBPz7wjb+684HstS/+2PT8f/7Jmv/ibV+8t2/auH/mA5d/4frT8WC/n8AbP0fB0LX/3EIZP6PGbD1f8yErf9jFmrH/3eM3H+c/nXraefAmF9XH0uD/l0kaP9OK1vufz4Yuvuf3Vl4pYLyF0FX/7rz+I4U8M+Grv51ZwXOFfDPCfHH5o/o218y3n+2evry/a5dedeoqPmrYHt+1/eIP082IIj2/KOF/8PNV0n/m8X+92Loxv9dngpB/zsUuvrXnQNaIuCfC1v9Ow+6+rcycc1U+edDf//zEQL+w6Crf90BjuUC/sND/I1hm6yff67v+5ct/B9urLL0fyyA7fO/pbDd/1yG2vpnqEf9V8f/jq7jM+nQPycLxr+FsNU/br7W1D+/oV0qKH85aq3/PcaPWP7o4eOM1w83P+T3BIe1ftDQv7+lPVXQ/iqgq3+PoV0i4K+Ebfx3Uaj/W+ifI6Crf1zzP1Fw/4+Erv45nvZYAf9i2OqfJdDVPyfRHiUo/1Ehfuc/cM/DOP9BlOefm8A2NegHv6Slf08RtL+joat/j6M9QcB/DGzjv268tNQ/x8JW/xwHW/2zFLX1zzCP+g9i/rwbiDPr+Ew69M9Fgvbv9EJS/zS8A6V+w3f+UNGP0cOvvwT9WGipHy38H04vavo//kD7e8H4dzx047/n0l4i4D8Buvr3d7SnC/hPhK3+PQm2+vdk6Orfs2gvENz/U6Crf8+jPVvAfyqq9a9G/Nntf3H68aAI+a3f31Lf9aOF/+M06Po/LqQ9Q9D+T4d+/PdiAf8Z0NW/59CeL+A/E7b6181Xlvr3LNjq37Nhq3/Pgf1zM8mkoh+ihy9/AfphxTE++iHu/xju0f+r479/quMz6fB/XCcY/5xWsIz/Or2iqX9W0C4XlP9c6OqfK2mvF/CfB139czntpQL+82Grfy6Arf65MFT+TWH/qtuP5/RDlEMAcmCbMl0/aOjfZbTXCPrfRdDVv1fRXiHgvxi28d9LoKt/rqW9TFD+P0Jf/6wU8F8KXf3zZ8SfH0+V/zLY6h+3TrLUP5dj01n/+6bRZaWVRfNLi8t980d8BWDmv/8x/fp3GWz17xWoHf8d4dH/g8CNpy8RN9XxmXToH0n53XiZm/jZQv8sR/X7LzT0z+20tyH18X8FVPWPuPxXQlf/3EF7o6D8V0Ff/9wn4L8aG1p/pE//XAPd+M8ttHcLyn8tdNe/d9LeKuC/DtXr3zsev+VheKSl8Eu++vGLxFiyMojHdaXJev79Bbz/Mbif9mZB+1sJXf1zD+1fBPzXQ1f/rKa9V8B/A3T1zyrauwT8N8JW/7i6Ghm6/46/KHH6xyGYwP+5WkjtfeDdIvC7ddrAxM8FZFsSefUBtIjAfzNs339+C/Te/+iu06Q6CNGkej9TI/doffJ3dT4jYz3+LvXM73t+afImRU2+9y8/ce5P1BNooui/W1Fbf20f+RzTFqH400N1fCYd+usZpD7+uvHa8vzR26B7/ujfaB8TlP926MafHqd9VsB/B3T11xraBwT8d8I2/hTe95vp57/56gd38Ese4jGx3hHyW98/3/NHLc6fvQu6+tsJ2KcE/e9u6OrvJ2gfEfDfA9v4073Q1V9P0z4oKP990D1/9AXa5wX890NXfz1H+6SAfzVs9ddfUa2/Gt7f4pcy/fxRi/jjA7B9/8qD0D1/9FHaFwX9/yHYnj+6Brrnj/4dsvNHH4bt+aOPwPb80Uexvv6NGH52+jc2nmdzIH21js/8P/3rm3z9H77np2R6/N03+eofLf/H+4Lxz/kKLP0fzl+huf/2Tdo3BOV/HLr+j7doPxDwPwFd/8drtC8L+J/EpuP/sNC/T0FX/75O+67g/j8NXf37Nu0/BPzPwFb/Pgtd/fse7SuC8j8HXf37Me1HAv7nEda/1CCI+792jVD+LNimhveX+iUN/8eHtO8I2t8LsPV/OL1iuf/2Rdjq35egq3//SfupoP5fhq3+fQW6+vcTyPTvq7DVv69Bb/93fX//jr/+9Xt+03f+sPB/vI71/R+DI35/5/9Icn9Rx2fSEf//UTD+ubWypf5147Wm/l1L+7Wg/G9AV/9+Q/uTgP9N6Orff9N+JuB/Cw3xf62kEf9378Ny+mdhhPzZxuXPxPj/29D1f/wH8eeIU+V/B7r+j29pvxTwvwtb/8d70PV//ED7uaD870PX/+EGsSoB/wfQjf+vo/1OwP8hbPWv8xU1xP91UkP8X97+Poat/+MT6Po/vqLNClLv/5/C1v/xL+j6P4JA5v/4DLb+j89hG///Auvr36ivYHT73119dmIdNKljMN3E4/+FDfH/6GlTif+3EYx/Ti9b+j+cXtD0f7Rg2ZsLyv8ldP0fm5F7cwH/V9D1fzQldyMB/9eo3/H/tdDVvzm8960F9/8b6OrfluTOFfB/C1v9+x109W8ey95YUP7voat/25O7nYD/B9SM/49G3P8V5UFE63OEGuL/fknD/9GWhWglaH8/wtb/4WIFlvH/dbDVv1XQ1b/NWPcdBfXvGr2l/g0CXf3bQah/swJb/Zsd4t+Y75ZpSJt+8p0/6vv+D7XzByNugMjE/R+NgvX9X1FfIRze/9E1gv/L4vw9pxUsz99zfkLN8/d68npbCub/poHt+Xs5ga7/oxev11lQ/txA3//RT8DfLMRvrT/u//y2VT75l3ry+06BzRJwZyrNiJDf+v5bnL/YPND1f3Xj9foI2n+LQNf/tRWv113A7/y1iv6voD+vt4WAv2Wg6//amtfrIuBvFeiev+feHdBXwN860N3/0YPX6y3gzwts/R8uVpP0f9T3959l+vlzvsni/MXNg3D8Pf3nL7YNbM9fbBfitzh/r32I/79QSwECFwsUAAIACABqti5V3/fBhzwPAAAI5gAACQAJAAAAAAAAAAAAAIAAAAAAVUlQYWNrYWdlVVQFAAfpWiJjUEsFBgAAAAABAAEAQAAAAHQPAAAAAA==


[Script]
Call 大漠()
Delay 500
二三洞 = array(29081,29689)
Do
	Form1.頭上.Text = int(Plugin.Memory.Read32Bit(Hwnd, &H011CD768))
	Form1.第二洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, &H011CD72C))
	Form1.第三洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, &H011CD730))
	Form1.第四洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, &H011CD734))
	對話視窗 = int(Plugin.Memory.Read32Bit(Hwnd, &H00F80558))
	
	If 對話視窗 > 0 Then '對話中選擇
		If int(Form1.第三洞.Text) <> int(Form1.三洞.Text) Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
		ElseIf int(Form1.第二洞.Text) <> int(Form1.二洞.Text) Then
			dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
		ElseIf int(Form1.第三洞.Text) > 0 AND int(Form1.第二洞.Text) > 0 Then
			If int(Form1.第三洞.Text) = int(Form1.三洞.Text) AND int(Form1.第二洞.Text) = int(Form1.二洞.Text) Then '第二三洞非指定重新附魔
				EndScript
			Else
				dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
			End If
		else
			dm_ret = dm.FindStr(0, 0, 1024, 768, "開始吧", "000000-000000", 1.0, intX1, intY1)
			dm_ret = dm.FindStr(0, 0, 1024, 768, "高級模式", "000000-000000", 1.0, intX2, intY2)
		End If
		
		If (intX1 > 0 And intY1 > 0) OR (intX2 > 0 And intY2 > 0) Then 
			dm.KeyPress 40
			Delay 50 '會誤判請提高延遲
		End If
		
		dm.KeyPress 13
	Else '非對話點NPC
		If int(Form1.頭上.Text) > 0 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "時空頭附魔", "ffffff-000000", 1.0, intX, intY)
			dm.MoveTo intX + 25, intY + 25
			dm.LeftClick 
		Else 
			dm.KeyPress 112 'F1重新裝備
		End If
	End If
	Delay 200
Loop

Function 大漠()
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath() & "光雨"
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0, "光與精煉.txt")
	Hwnd = Plugin.Window.Find(0, "Ragnarok")
	dm_ret = dm.BindWindow(Hwnd,"gdi","dx2","dx",4)
End Function

