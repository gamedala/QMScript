[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=11f18447-53d2-4fdd-bb32-35e171df28f2
Description=光雨-精煉UI
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[UIPackage]
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


[Script]
If Plugin.File.GetFileLength("c:\dm\光雨精煉.txt") = 0 Then 
    PutAttachment "c:\dm", "*.*"
End If
Call 大漠()
Delay 100
//自己修改視窗NPC位置(綁定具柄後的位置)
dm.GetCursorPos x,y
NPC座標 = array(x, y)
TracePrint x & "-" & y
裝備位置 = int(Form1.選單位置.Text)
//類型1 精煉 2附魔
動作類型 = int(Form1.動作類型.ListIndex)
//洞數 1=4洞 2=3洞
洞數 = int(Form1.洞數.ListIndex)
選單洞數 = int(Form1.選單洞數.Text)
記憶體位置 = array(0, 18667320, 18667552, 18665464, 18666392, 18665928, 18666856, 18665696, 18666624, 18666160, 18667088, 18671960, 18672192, 18670104, 18671032, 18670568, 18671496, 18670336, 18671264, 18670800, 18671728)
位置 = int(Form1.位置.ListIndex)
物品 = "&H0" & Hex(記憶體位置(位置))
精煉 = "&H0" & Hex(記憶體位置(位置)+52)
一洞 = "&H0" & Hex(記憶體位置(位置)-16)
二洞 = "&H0" & Hex(記憶體位置(位置)-12)
三洞 = "&H0" & Hex(記憶體位置(位置)-8)
四洞 = "&H0" & Hex(記憶體位置(位置)-4)
Do
	If 動作類型 = 1 Then 
		精煉值 = int(Plugin.Memory.Read32Bit(Hwnd, 精煉))
	TracePrint 精煉值 & Form1.精煉.Text
		If 精煉值 >= int(Form1.精煉.Text) Then 
			Do
				Call Plugin.Media.Beep(988, 100) //蜂鳴一秒	
			Loop
		End If
	ElseIf 動作類型 = 2 Then
		If 洞數 = 1 Then 
			洞 = Plugin.Memory.Read32Bit(Hwnd, 一洞)
		ElseIf 洞數 = 2 Then 
			洞 = Plugin.Memory.Read32Bit(Hwnd, 二洞)
		ElseIf 洞數 = 3 Then 
			洞 = Plugin.Memory.Read32Bit(Hwnd, 三洞)
		ElseIf 洞數 = 4 Then 
			洞 = Plugin.Memory.Read32Bit(Hwnd, 四洞)
		End If
		If 洞 = Form1.附魔.Text Then 
			Do
				Call Plugin.Media.Beep(988, 100) //蜂鳴一秒	
			Loop
		End If
	End If
	對話視窗 = Plugin.Memory.Read32Bit(Hwnd, &H00F80558)
	If 對話視窗 > 0 Then 
		If 動作類型 = 1 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "物品選項簡略設置", "0063ce-000000", 1.0, intX, intY)
		ElseIf 動作類型 = 2 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "附魔道具說明", "008cff-000000", 1.0, intX, intY)
		End If
		//TracePrint "intX: " &intX&" intY :"&intY
		If intX > 0 AND intY > 0 Then 
			For i = 1 To 裝備位置
				TracePrint "裝備位置: "&裝備位置&" 按: down " & i
				dm.KeyPress 40
				Delay 100
			Next
			dm.KeyPress 13
		Else 
			If 動作類型 = 2 Then 
				dm_ret = dm.FindStr(0, 0, 1024, 768, "第四洞", "008cff-000000", 1.0, intX, intY)
				TracePrint 選單洞數
				If intX > 0 AND intY > 0 Then 
					If 選單洞數 > 0 Then 
						For i = 1 To 選單洞數
							TracePrint "洞數: "& 選單洞數 &" 按: down " & i
							dm.KeyPress 40
							Delay 20
						Next
					End If	
				End If
				dm_ret = dm.FindStr(0, 0, 1024, 768, "請繼續", "000000-000000", 1.0, intX, intY)
				If intX > 0 AND intY > 0 Then 
					dm.KeyPress 40
					Delay 20
				End If
			End If
			dm.KeyPress 13
		End If
	Else 
		dm.MoveTo NPC座標(0),NPC座標(1)
		dm.LeftClick
	End If
	Delay 50
Loop

Function 大漠()
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath()
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0, "光與精煉.txt")
	Hwnd = Plugin.Window.Find(0, "Ragnarok")
	dm_ret = dm.BindWindow(Hwnd, "gdi", "dx2", "dx", 4)
End Function
