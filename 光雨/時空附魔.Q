[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=134846dd-0571-49e9-82cf-154ea695f2e4
Description=時空附魔
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
Call 大漠()
Delay 500
Do
	位置 = 18164608
	Form1.頭上.Text = dm.ReadString(Hwnd, Hex(位置), 0, 10)
	Form1.第二洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, 位置-12))
	Form1.第三洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, 位置-8))
	Form1.第四洞.Text = int(Plugin.Memory.Read32Bit(Hwnd, 位置-4))
	對話視窗 = int(Plugin.Memory.Read32Bit(Hwnd, &H00F05990))
	
	If 對話視窗 > 0 Then '對話中選擇
		If int(Form1.第三洞.Text) > 0 and int(Form1.第三洞.Text) <> int(Form1.三洞.Text) Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
		ElseIf int(Form1.第二洞.Text) > 0 and int(Form1.第二洞.Text) <> int(Form1.二洞.Text) Then
			dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
		ElseIf int(Form1.第三洞.Text) > 0 AND int(Form1.第二洞.Text) > 0 Then
			If int(Form1.第三洞.Text) = int(Form1.三洞.Text) AND int(Form1.第二洞.Text) = int(Form1.二洞.Text) Then '第二三洞非指定重新附魔
				EndScript
			Else
				dm_ret = dm.FindStr(0, 0, 1024, 768, "我想把附魔初始化", "000000-000000", 1.0, intX1, intY1)
			End If
		else
			dm_ret = dm.FindStr(0, 0, 1024, 768, "開始吧", "000000-000000", 1.0, intX1, intY1)
			dm_ret = dm.FindStr(0, 0, 1024, 768, "高級模式", "000000-000000", 1.0, intX2, intY2)
		End If
		
		If (intX1 > 0 And intY1 > 0) OR (intX2 > 0 And intY2 > 0) Then 
			dm.KeyPress 40
			Delay 50 '會誤判請提高延遲
		End If
		
		dm.KeyPress 13
	Else '非對話點NPC
		If int(Form1.頭上.Text) > 0 Then 
			dm_ret = dm.FindStr(0, 0, 1024, 768, "時空頭附魔", "ffffff-000000", 1.0, intX, intY)
			dm.MoveTo intX + 25, intY + 25
			dm.LeftClick 
		Else 
			dm.KeyPress 112 'F1重新裝備
		End If
	End If
	Delay 200
Loop

Function 大漠()
	set dm = createobject("dm.dmsoft")
	base_path = dm.GetBasePath() & "光雨"
	dm_ret = dm.SetPath(base_path)
	dm_ret = dm.SetDict(0, "光與精煉.txt")
	Hwnd = Plugin.Window.Find(0, "Ragnarok")
	dm_ret = dm.BindWindow(Hwnd,"gdi","dx2","dx",4)
End Function