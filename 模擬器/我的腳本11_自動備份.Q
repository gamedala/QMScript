[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=50ce5051-924c-4a00-960c-28f6d4daf01e
Description=我的腳本1_自動備份
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
//Call 大漠設定
//
//Sub 大漠設定()
//    set dm = createobject("dm.dmsoft")
//	hwnds = dm.EnumWindow(0, "", "LDPlayerMainFrame", 2 + 4 + 8 + 16)
//	hwnds = split(hwnds, ",")
//	For i = 0 To UBound(hwnds)
//		title = dm.GetWindowTitle(hwnds(i))
//		模擬器 = dm.EnumWindow(hwnds(i), "sub", "subWin", 1 + 2 )
//	    dm_ret = dm.BindWindow(模擬器,"gdi","windows","windows",0)
//		TracePrint "模擬器: " & 模擬器 & " 標題: " & title & "  綁定: " & dm_ret
//	Next
//End Sub

Event Form1.Load
    Set dm = createobject("dm.dmsoft")
    Call 搜尋窗口
End Event

Event Form1.Add.Click

End Event

Event Form1.Start.Click
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.start.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.start.Caption = "停止"
    End If
End Event

Event Form1.選單.SelectChange
    帳號選擇內容 = Split(Form1.選單.List, "|")(Form1.選單.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.start.Caption = "停止"
    Else 
        Form1.start.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.選單.List, "|")(Form1.選單.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "D:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "D:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event

Sub 搜尋窗口
	hwnds = dm.EnumWindow(0, "", "LDPlayerMainFrame", 2 + 4 + 8 + 16)
	hwnds = split(hwnds, ",")
	For i = 0 To UBound(hwnds)
		title = dm.GetWindowTitle(hwnds(i))
		模擬器 = dm.EnumWindow(hwnds(i), "sub", "subWin", 1 + 2)
		選單內容 = 選單內容 & "|" & title & "," & 模擬器
	Next
	Form1.選單.List = 選單內容
	Form1.選單.ListIndex = 0
End Sub
