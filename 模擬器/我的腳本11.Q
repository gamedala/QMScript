[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=98eb60df-4320-4a23-9cf2-032a425ff75f
Description=我的腳本1
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
//Call 大漠設定
//
//Sub 大漠設定()
//    set dm = createobject("dm.dmsoft")
//	hwnds = dm.EnumWindow(0, "", "LDPlayerMainFrame", 2 + 4 + 8 + 16)
//	hwnds = split(hwnds, ",")
//	For i = 0 To UBound(hwnds)
//		title = dm.GetWindowTitle(hwnds(i))
//		模擬器 = dm.EnumWindow(hwnds(i), "sub", "subWin", 1 + 2 )
//	    dm_ret = dm.BindWindow(模擬器,"gdi","windows","windows",0)
//		TracePrint "模擬器: " & 模擬器 & " 標題: " & title & "  綁定: " & dm_ret
//	Next
//End Sub

Event Form1.Load
    Set dm = createobject("dm.dmsoft")
    Call 窗口
End Event


Event Form1.Button1.Click'儲存參數
    血量 = Form1.Slider1.Value'取血量參數
    魔力 = Form1.Slider2.Value'取魔力參數
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    Call Plugin.File.WriteINI(線程, "血量", 血量, "D:\test111.ini")'將血量參數寫入線程類別內
    Call Plugin.File.WriteINI(線程, "魔力", 魔力, "D:\test111.ini")
End Event

Event Form1.刷新.Click'指定下拉目標啟動
	Call 窗口
End Event

Event Form1.Button2.Click'指定下拉目標啟動
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex'下拉字串內容第幾位
    列表內容 = "請選擇"
    '回寫值到下拉控制項 
    If Split(帳號選擇內容, ",")(1) > 0 Then '下拉字串內容第二欄 如果線程編號大於0
        Form1.Button2.Caption = "啟動"
        For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))'返回下拉陣列最大數
            If Form1.ComboBox1.ListIndex = i Then 
                列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & ",0"'迴圈拼出下拉全字串內容並寫入0到指定下拉目標第二欄內
            Else 
                列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
            End If
        Next
        Form1.ComboBox1.List = 列表內容
        Form1.ComboBox1.ListIndex = 帳號選擇位置
    Else 
        Form1.Button2.Caption = "停止"
        BeginThread test()
    End If
End Event

Event Form1.ComboBox1.SelectChange
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)'下拉的所有定義字串內容
    If Split(帳號選擇內容, ",")(1) > 0 Then '如果線程編號大於0 
        Form1.Button2.Caption = "停止"
    Else 
        Form1.Button2.Caption = "啟動"
    End If
    線程 = Split(Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex), ",")(0)'取下拉字串第一欄
    血量 = Plugin.File.ReadINI(線程, "血量", "D:\test111.ini")'將血量參數從線程類別內讀取
    魔力 = Plugin.File.ReadINI(線程, "魔力", "D:\test111.ini")
    Form1.Slider1.Value = 血量
    Form1.Slider2.Value = 魔力
End Event

Sub test
    帳號選擇內容 = Split(Form1.ComboBox1.List, "|")(Form1.ComboBox1.ListIndex)
    MsgBox "帳號選擇內容" & 帳號選擇內容
    帳號選擇位置 = Form1.ComboBox1.ListIndex
    列表內容 = "請選擇"
    For i = 1 To UBound(Split(Form1.ComboBox1.List, "|"))
        If Form1.ComboBox1.ListIndex = i Then 
            列表內容 = 列表內容 & "|" & Split(Split(Form1.ComboBox1.List, "|")(i), ",")(0) & "," & GetThreadID()'迴圈拼出下拉全字串內容並寫入線程編號到指定下拉目標第二欄內
        Else 
            列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(i)'迴圈補全下拉字串內容
        End If
    Next
    Form1.ComboBox1.List = 列表內容
    Form1.ComboBox1.ListIndex = 帳號選擇位置
End Sub

Sub 窗口
	hwnds = dm.EnumWindow(0, "", "LDPlayerMainFrame", 2 + 4 + 8 + 16)
	hwnds = split(hwnds, ",")
	列表內容 = "請選擇"
	For i = 0 To UBound(hwnds)
		title = dm.GetWindowTitle(hwnds(i))
		For ii = 1 To UBound(Split(Form1.ComboBox1.List, "|"))
			If title = Split(Split(Form1.ComboBox1.List, "|")(ii), ",")(0) Then 
				相同 = True
				Exit For
			Else 
				相同 = False
			End If
		Next
		
		If 相同 = True Then 
			列表內容 = 列表內容 & "|" & Split(Form1.ComboBox1.List, "|")(ii)
		Else 
			模擬器 = dm.EnumWindow(hwnds(i), "sub", "subWin", 1 + 2)
			列表內容 = 列表內容 & "|" & title & ",0"
		End If
	Next
	Form1.ComboBox1.List = 列表內容
	Form1.ComboBox1.ListIndex = 0
End Sub